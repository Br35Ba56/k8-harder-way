- name: Copy worker cert/key
  copy:
    src: "crypto/{{ inventory_hostname }}.pem"
    dest: /etc/ssl
  when: inventory_hostname in groups['worker']

- name: Copy worker cert/key
  copy:
    src: "crypto/{{ inventory_hostname }}_privkey.pem"
    dest: /etc/ssl
  when: inventory_hostname in groups['worker']

- name: Copy controller keys
  copy:
    src: "{{ item.key_path }}"
    dest: /etc/ssl
  when: inventory_hostname in groups['controller'] and 'worker' not in item.key_path
  with_items: "{{ certs }}"

- name: Copy controller certs
  copy:
    src: "{{ item.cert_path }}"
    dest: /etc/ssl
  when: inventory_hostname in groups['controller'] and 'worker' not in item.cert_path
  with_items: "{{ certs }}"
